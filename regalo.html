<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para mi Fishy üåª | Dispensador de Besos</title>
    <style>
        /* --- ESTILOS GENERALES --- */
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(to bottom, #87CEEB, #E0F7FA); /* Cielo azulado */
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
            position: relative;
        }

        /* T√≠tulo */
        h1 {
            position: absolute;
            top: 10px;
            width: 100%;
            text-align: center;
            color: #d63031;
            text-shadow: 2px 2px 0px #fff;
            font-size: 1.8rem;
            z-index: 1000;
            pointer-events: none;
        }

        /* Contador */
        #counter-box {
            position: absolute;
            top: 60px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 15px;
            border-radius: 15px;
            border: 2px solid #ff6b6b;
            color: #d63031;
            font-weight: bold;
            font-size: 1.1rem;
            z-index: 1000;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
        }

        /* --- LA ABEJITA (M√°s lenta) --- */
        #bee {
            position: absolute;
            font-size: 50px;
            cursor: pointer;
            z-index: 5; /* Se esconde detr√°s de las flores (z-index 10) */
            filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.3));
            animation: flyChaos 30s infinite linear; /* **Ajuste de velocidad** */
            transition: transform 0.1s;
        }
        #bee:active { transform: scale(0.8); }

        /* Animaci√≥n ca√≥tica m√°s suave y lenta */
        @keyframes flyChaos {
            0% { left: -5%; top: 10%; transform: scaleX(1); }
            15% { left: 25%; top: 75%; transform: scaleX(1) rotate(15deg); }
            35% { left: 60%; top: 15%; transform: scaleX(1) rotate(-10deg); }
            50% { left: 105%; top: 40%; transform: scaleX(-1); } /* Gira */
            65% { left: 70%; top: 85%; transform: scaleX(-1) rotate(10deg); }
            85% { left: 30%; top: 20%; transform: scaleX(-1) rotate(-15deg); }
            100% { left: -5%; top: 60%; transform: scaleX(-1); }
        }
        
        /* --- DISE√ëO DE GIRASOL (Ajuste de posicionamiento) --- */
        .sunflower-container {
            position: absolute;
            /* bottom: -50px; <-- Eliminado para usar 'top' y 'height' */
            z-index: 10; 
            display: flex;
            flex-direction: column;
            align-items: center;
            pointer-events: none;
            transform-origin: bottom center;
            animation: sway 4s infinite ease-in-out alternate;
        }

        .flower-head {
            position: relative;
            width: 80px;
            height: 80px;
            background: #5c4033; 
            border-radius: 50%;
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.5);
            z-index: 2;
        }

        .flower-head::after {
            content: "::::";
            color: #3e2723;
            font-size: 20px;
            letter-spacing: 2px;
            position: absolute;
            top: 25%;
            left: 25%;
            font-weight: bold;
        }

        .petals {
            position: absolute;
            top: -20px;
            left: -20px;
            width: 120px;
            height: 120px;
            z-index: 1;
            animation: rotateHead 20s infinite linear;
        }

        .petal {
            position: absolute;
            width: 30px;
            height: 60px;
            background: #ffdd00;
            border-radius: 50% 50% 10px 10px;
            top: 30px;
            left: 45px;
            transform-origin: center bottom;
            box-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .petal:nth-child(1) { transform: rotate(0deg) translateY(-40px); }
        .petal:nth-child(2) { transform: rotate(45deg) translateY(-40px); }
        .petal:nth-child(3) { transform: rotate(90deg) translateY(-40px); }
        .petal:nth-child(4) { transform: rotate(135deg) translateY(-40px); }
        .petal:nth-child(5) { transform: rotate(180deg) translateY(-40px); }
        .petal:nth-child(6) { transform: rotate(225deg) translateY(-40px); }
        .petal:nth-child(7) { transform: rotate(270deg) translateY(-40px); }
        .petal:nth-child(8) { transform: rotate(315deg) translateY(-40px); }

        .stem {
            width: 10px;
            height: 100vh; /* Se extiende verticalmente */
            background: #4caf50;
            margin-top: -10px;
            z-index: 0;
            position: relative;
        }

        .leaf {
            width: 40px;
            height: 20px;
            background: #4caf50;
            position: absolute;
            border-radius: 0 50% 50% 0;
        }
        .leaf.left { left: -40px; top: 50px; border-radius: 50% 0 0 50%; transform: rotate(-10deg); }
        .leaf.right { right: -40px; top: 100px; transform: rotate(10deg); }

        @keyframes sway {
            from { transform: rotate(2deg); }
            to { transform: rotate(-2deg); }
        }

        /* --- POPUPS --- */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            visibility: hidden;
            opacity: 0;
            transition: all 0.3s;
            z-index: 2000;
        }
        .overlay.show { visibility: visible; opacity: 1; }

        .popup-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            border: 4px solid #ff6b6b;
            box-shadow: 0 0 25px rgba(255, 255, 255, 0.5);
            max-width: 85%;
        }

        /* Carta Final */
        .letter-content {
            background: #fffdf0;
            padding: 40px;
            border-radius: 5px;
            border: 2px solid #d4af37;
            text-align: center;
            position: relative;
            max-width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        .letter-text {
            font-family: 'Georgia', serif;
            font-size: 1.3rem;
            color: #333;
            font-style: italic;
            line-height: 1.6;
            margin: 20px 0;
        }

        button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 10px;
        }

    </style>
</head>
<body>

    <h1>Dispensador de besos para mi Fishy</h1>
    <div id="counter-box">Besitos: <span id="count-display">0</span> / 30</div>

    <audio id="secret-audio" src="secret_song.mp3" preload="auto" loop></audio>

    <div id="field"></div>

    <div id="bee" onclick="catchBee()">üêù</div>

    <div id="muacki-overlay" class="overlay" onclick="closePopup('muacki-overlay')">
        <div class="popup-card">
            <h2 style="font-size: 3rem; margin:0; color:#ff4757;">Muacki! üíã</h2>
            <p>¬°Se esconde r√°pido! ¬°Sigue buscando!</p>
        </div>
    </div>

    <div id="letter-overlay" class="overlay">
        <div class="letter-content">
            <h2 style="color: #d4af37; margin-top:0;">üíå ¬°Besitos Desbloqueados!</h2>
            <p class="letter-text">
                "Mi Evelyn, te amo tanto,<br>
                esta p√°gina es para que cuando no pueda estar<br>
                sientas mi compa√±√≠a a trav√©s de besitos."
            </p>
            <p style="color: #ff6b6b; font-weight:bold;">‚ù§Ô∏è Te amo.</p>
            <button onclick="closePopup('letter-overlay')">Cerrar y escuchar</button>
        </div>
    </div>

    <script>
        // --- CONFIGURACI√ìN ---
        let besos = 0;
        const metaBesos = 30;
        const bee = document.getElementById('bee');
        const countDisplay = document.getElementById('count-display');
        const audio = document.getElementById('secret-audio');

        // --- GENERADOR DE GIRASOLES ---
        function createSunflowers() {
            const field = document.getElementById('field');
            const numberOfFlowers = 25;

            for (let i = 0; i < numberOfFlowers; i++) {
                const flower = document.createElement('div');
                flower.classList.add('sunflower-container');

                // HTML interno del girasol
                flower.innerHTML = `
                    <div class="petals">
                        <div class="petal"></div><div class="petal"></div>
                        <div class="petal"></div><div class="petal"></div>
                        <div class="petal"></div><div class="petal"></div>
                        <div class="petal"></div><div class="petal"></div>
                    </div>
                    <div class="flower-head"></div>
                    <div class="stem">
                        <div class="leaf left"></div>
                        <div class="leaf right"></div>
                    </div>
                `;

                // Aleatoriedad
                const randomLeft = Math.random() * 95; /* Evitar que se salgan demasiado por la derecha */
                const randomScale = 0.5 + Math.random() * 0.8;
                const randomBottom = -80 + Math.random() * 150; /* Algunos m√°s en el horizonte */
                const randomDelay = Math.random() * 5;
                
                // Aplicar estilos
                flower.style.left = randomLeft + '%';
                flower.style.bottom = randomBottom + 'px';
                flower.style.transform = `scale(${randomScale})`;
                flower.style.animationDelay = `-${randomDelay}s`;
                
                field.appendChild(flower);
            }
        }

        // --- L√ìGICA DEL JUEGO ---
        function catchBee() {
            besos++;
            countDisplay.innerText = besos;
            bee.style.animationPlayState = 'paused';

            if (besos >= metaBesos) {
                document.getElementById('letter-overlay').classList.add('show');
                // Intentar reproducir audio (la reproducci√≥n autom√°tica puede ser bloqueada, por eso se hace al click)
                // audio.play().catch(e => console.error("Error al intentar reproducir audio autom√°ticamente:", e));
            } else {
                document.getElementById('muacki-overlay').classList.add('show');
            }
        }

        function closePopup(id) {
            document.getElementById(id).classList.remove('show');
            bee.style.animationPlayState = 'running';
            
            // Si cierra el POPUP de la carta, iniciar el audio
            if (id === 'letter-overlay') {
                audio.play().catch(e => {
                    console.error("No se pudo iniciar el audio:", e);
                    // Opcional: mostrar un mensaje que diga "Activa el audio para la sorpresa"
                });
            }
        }

        // Iniciar el campo de flores al cargar
        createSunflowers();

    </script>

</body>
</html>